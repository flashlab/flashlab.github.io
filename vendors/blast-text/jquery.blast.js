/*! Blast.js (2.0.0): julian.com/research/blast (C) 2015 Julian Shapiro. MIT @license: en.wikipedia.org/wiki/MIT_License */
!function(e,t,a,r){var n=function(){if(a.documentMode)return a.documentMode;for(var e=7;e>0;e--){var t=a.createElement("div");if(t.innerHTML="\x3c!--[if IE "+e+"]><span></span><![endif]--\x3e",t.getElementsByTagName("span").length)return t=null,e;t=null}}(),s=t.console||{log:function(){},time:function(){}},i="blast",l="–—′’'“″„\"(«.…¡¿′’'”″“\")».…!?",d="\\u0041-\\u005A\\u0061-\\u007A\\u00C0-\\u017F\\u0100-\\u01FF\\u0180-\\u027F",o={abbreviations:new RegExp("[^"+d+"](e\\.g\\.)|(i\\.e\\.)|(mr\\.)|(mrs\\.)|(ms\\.)|(dr\\.)|(prof\\.)|(esq\\.)|(sr\\.)|(jr\\.)[^"+d+"]","ig"),innerWordPeriod:new RegExp("["+d+"].["+d+"]","ig"),onlyContainsPunctuation:new RegExp("[^"+l+"]"),adjoinedPunctuation:new RegExp("^["+l+"]+|["+l+"]+$","g"),skippedElements:/(script|style|select|textarea)/i,hasPluginClass:new RegExp("(^| )blast( |$)","gi")};e.fn.blast=function(r){function l(e){return e.replace(/{{(\d{1,3})}}/g,(function(e,t){return String.fromCharCode(t)}))}function c(e,t){var r=-1,n=0;if(3===e.nodeType&&e.data.length){if(p.nodeBeginning&&(e.data=t.search||"sentence"!==t.delimiter?l(e.data):e.data.replace(o.abbreviations,(function(e){return e.replace(/\./g,"{{46}}")})).replace(o.innerWordPeriod,(function(e){return e.replace(/\./g,"{{46}}")})),p.nodeBeginning=!1),-1!==(r=e.data.search(u))){var s=e.data.match(u),d=s[0],g=s[1]||!1;""===d?r++:g&&g!==d&&(r+=d.indexOf(g),d=g);var m=e.splitText(r);m.splitText(d.length),n=1,t.search||"sentence"!==t.delimiter||(m.data=l(m.data));var h=function(e,t){var r=a.createElement(t.tag);if(r.className=i,t.customClass&&(r.className+=" "+t.customClass,t.generateIndexID&&(r.id=t.customClass+"-"+p.blastedIndex)),"all"===t.delimiter&&/\s/.test(e.data)&&(r.style.whiteSpace="pre-line"),!0===t.generateValueClass&&!t.search&&("character"===t.delimiter||"word"===t.delimiter)){var n,s=e.data;"word"===t.delimiter&&o.onlyContainsPunctuation.test(s)&&(s=s.replace(o.adjoinedPunctuation,"")),n="blast-"+t.delimiter.toLowerCase()+"-"+s.toLowerCase(),r.className+=" "+n}return t.aria&&r.setAttribute("aria-hidden","true"),r.appendChild(e.cloneNode(!1)),r}(m,t,p.blastedIndex);m.parentNode.replaceChild(h,m),p.wrappers.push(h),p.blastedIndex++}}else if(1===e.nodeType&&e.hasChildNodes()&&!o.skippedElements.test(e.tagName)&&!o.hasPluginClass.test(e.className))for(var f=0;f<e.childNodes.length;f++)p.nodeBeginning=!0,f+=c(e.childNodes[f],t);return n}var u,g=e.extend({},e.fn.blast.defaults,r),p={};if(g.search.length&&("string"==typeof g.search||/^\d/.test(parseFloat(g.search))))g.delimiter=g.search.toString().replace(/[-[\]{,}(.)*+?|^$\\\/]/g,"\\$&"),u=new RegExp("(?:^|[^-"+d+"])("+g.delimiter+"('s)?)(?![-"+d+"])","i");else switch("string"==typeof g.delimiter&&(g.delimiter=g.delimiter.toLowerCase()),g.delimiter){case"all":u=/(.)/;break;case"letter":case"char":case"character":u=/(\S)/;break;case"word":u=/\s*(\S+)\s*/;break;case"sentence":u=/(?=\S)(([.]{2,})?[^!?]+?([.…!?]+|(?=\s+$)|$)(\s*[′’'”″“")»]+)*)/;break;case"element":u=/(?=\S)([\S\s]*\S)/;break;default:if(!(g.delimiter instanceof RegExp))return s.log("blast: Unrecognized delimiter, empty search string, or invalid custom Regex. Aborting."),!0;u=g.delimiter}function m(a,r){r.debug&&s.time("blast reversal");var l=!1;a.removeClass("blast-root").removeAttr("aria-label").find(".blast").each((function(){if(e(this).closest(".blast-root").length)l=!0;else{var t=this.parentNode;n<=7&&t.firstChild.nodeName,t.replaceChild(this.firstChild,this),t.normalize()}})),t.Zepto?a.data(i,void 0):a.removeData(i),r.debug&&(s.log("blast: Reversed Blast"+(a.attr("id")?" on #"+a.attr("id")+".":".")+(l?" Skipped reversal on the children of one or more descendant root elements.":"")),s.timeEnd("blast reversal"))}if(this.each((function(){var t=e(this),n=t.text();if(!1!==r){p={blastedIndex:0,nodeBeginning:!1,wrappers:p.wrappers||[]},void 0===t.data(i)||"search"===t.data(i)&&!1!==g.search||(m(t,g),g.debug&&s.log("blast: Removed element's existing Blast call.")),t.data(i,!1!==g.search?"search":g.delimiter),g.aria&&t.attr("aria-label",n),g.stripHTMLTags&&t.html(n);try{a.createElement(g.tag)}catch(e){g.tag="span",g.debug&&s.log("blast: Invalid tag supplied. Defaulting to span.")}t.addClass("blast-root"),g.debug&&s.time(i),c(this,g),g.debug&&s.timeEnd(i)}else!1===r&&void 0!==t.data(i)&&m(t,g);g.debug&&e.each(p.wrappers,(function(e,t){s.log("blast ["+g.delimiter+"] "+this.outerHTML),this.style.backgroundColor=e%2?"#f12185":"#075d9a"}))})),!1!==r&&!0===g.returnGenerated){var h=e().add(p.wrappers);return h.prevObject=this,h.context=this.context,h}return this},e.fn.blast.defaults={returnGenerated:!0,delimiter:"word",tag:"span",search:!1,customClass:"",generateIndexID:!1,generateValueClass:!1,stripHTMLTags:!1,aria:!0,debug:!1}}(window.jQuery||window.Zepto,window,document);